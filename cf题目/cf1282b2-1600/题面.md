## K 以一个的价格购买（困难版）
时间限制：$2000s$ 空间限制：$256MB$  
#### 题目描述：
这是这个问题的困难版本。唯一的区别在于$k$的约束 —— 在这个版本中：$2 \le k \le n$.

瓦西亚来到商店为他的朋友们购买新年礼物。结果他非常幸运 —— 今天商店里有“$k$件商品只需一件商品的价格”的优惠活动。

利用这个优惠，瓦西亚可以购买<span class="tex-font-style-bf">恰好</span>$k$件任意商品，只需支付最贵的那个。瓦西亚决定抓住这个机会，用他手头的钱为他的朋友们买尽可能多的商品。

更正式地说，对于每个商品，它的价格由$a_i$确定 —— 即它的成本是多少。最初，瓦西亚有$p$个硬币。他想购买尽可能多的商品。瓦西亚可以根据需要执行以下任一操作：

- 如果他当前有足够的硬币（即$p \ge a_i$），瓦西亚可以购买索引为$i$的商品一件。购买了这个商品后，瓦西亚的硬币数量会减少$a_i$（即$p := p - a_i$）。
- 如果他当前有足够的硬币（即$p \ge a_i$），瓦西亚可以购买索引为$i$的商品，并且还可以选择恰好$k-1$件价格不超过$a_i$的商品。因此，他购买所有这$k$个商品，他的硬币数量减少$a_i$（即$p := p - a_i$）。

请注意，每种商品只能购买一次。

例如，如果商店现在有$n=5$件商品，价格分别为$a_1=2, a_2=4, a_3=3, a_4=5, a_5=7$，$k=2$，而瓦西亚有$6$个硬币，那么他可以购买$3$件商品。瓦西亚将以$2$个硬币购买索引为$1$的商品，而不使用优惠。索引为$2$和$3$的商品瓦西亚将使用优惠购买，他将支付$4$个硬币。可以证明瓦西亚不能用六个硬币购买更多商品。

帮助瓦西亚找出他可以购买的最大数量的商品。
#### 输入描述：
第一行包含一个整数 $t$ ($1 \le t \le 10^4$) — 测试中的测试用例数量。</p><p>接下来的行包含 $t$ 个测试用例的描述。</p><p>每个测试用例的第一行包含三个整数 $n, p, k$ ($2 \le n \le 2\cdot10^5$, $1 \le p \le 2\cdot10^9$, $2 \le k \le n$) — 商店中商品的数量，Vasya 拥有的硬币数量以及可以购买的商品数量，这些商品中最贵的商品的价格。</p><p>每个测试用例的第二行包含 $n$ 个整数 $a_i$ ($1 \le a_i \le 10^4$) — 商品的价格。</p><p>保证所有测试用例中 $n$ 的总和不超过 $2\cdot10^5$。
#### 输出描述：
<p>每个测试用例单独一行打印一个整数 $m$ — Vasya 可以购买的最大商品数量。</p>
#### 样例输入输出：
|输入1| 输出1 |
|-- | -- |
|8<br />5 6 2<br />2 4 3 5 7<br />5 11 2<br />2 4 3 5 7<br />3 2 3<br />4 2 6<br />5 2 3<br />10 1 3 9 2<br />2 10000 2<br />10000 10000<br />2 9999 2<br />10000 10000<br />4 6 4<br />3 2 3 2<br />5 5 3<br />1 2 2 1 2|3<br />4<br />1<br />1<br />2<br />0<br />4<br />5|
