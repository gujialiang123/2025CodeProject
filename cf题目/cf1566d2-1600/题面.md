# 座位安排（难版本）

## 题面



电影院的座位可以表示为一个 $n\times m$ 的表格，行被标号为 $1\sim n$，第 $k$ 行的座位号从左到右为 $m(k-1)+1\sim mk$。

有 $nm$ 个人想去电影院看一部新电影，编号为 $1\sim nm$。你需要给每个人分配恰好一个座位。

在这个电影院中，座位编号越小，就能越好地看到屏幕上的内容。第 $i$ 个人的视力水平为 $a_i$。定义 $s_i$ 为座位编号，它将被分配给第 $i$ 个人。你希望为视力水平较低的人提供更好的位置，因此对于 $\forall i,j,a_i\lt a_j\Rightarrow s_i\lt s_j$。

当你分配好所有座位后，他们会开始就座。按照 $1\sim nm$ 的顺序，每个人进入大厅并坐到自己的座位上。为了到达他们的位置，该人将走到他们座位的那排，并开始从该排的第一个座位从左到右移动到他们的座位。虽然某些地方可以自由移动，但有些地方可能已经坐上了人。定义该人的不便值 $v_i$ 为经过的已坐人座位的总数。

例如，$m=5$ 时，某人座位号为 $4$，座位 $1,3,5$ 已坐人，那么不便值将为 $2$，因为他将会经过 $1,3$ 两个已坐人座位。

求满足条件的情况下 $\sum v_i$ 的最小值。注意本题 $T$ 组数据。

保证 $1\le a_i\le10^9,1\le T\le100,1\le n,m\le300,1\le\sum (nm)\le10^5$。



## 输入格式

输入由多个测试用例组成。第一行包含单个整数 t （1<=t<=100）—测试用例的数量。下面是测试用例的描述。

每个测试用例的第一行包含两个整数n $和m（ 1<=n,m<=300 ）—分别表示行数和每行中的位置。

每个测试用例的第二行包含n*m个整数ai,1<=ai<=10^9，其中ai是i第i个人的视力水平。

可以保证所有测试用例的n*m的总和不超过10^5 。

## 输出格式

对于每个测试用例输出一个整数——满足条件的情况下 $\sum v_i$ 的最小值。

## 样例 #1

### 样例输入 #1

```
7
1 2
1 2
3 2
1 1 2 2 3 3
3 3
3 4 4 1 1 1 1 1 2
2 2
1 1 2 1
4 2
50 50 50 50 3 50 50 50
4 2
6 6 6 6 2 2 9 6
2 9
1 3 3 3 3 3 1 1 3 1 3 1 1 3 3 1 1 3
```

### 样例输出 #1

```
1
0
4
0
0
0
1
```

## 提示

在第一个测试用例中，有一种分配座位的方法：第一个人坐在第一位，第二个人坐在第二位。造成的不便总共是1美元。

在第二个测试案例中，最佳座位是这样的：

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1566D2/46f26744e5411d13af43bc68c4d54fb7352debca.png)
 
单元格中的数字是这个位置上的人的索引。