## 药水（困难版）
时间限制：$1000ms$ 空间限制：$256MB$
#### 题目描述：
在直线上有 $n$ 瓶药剂，第一瓶在最左边，第 $n$ 瓶在最右边。每瓶药剂饮用后会增加你的生命值 $a_i$。$a_i$ 可以是负数，意味着该瓶药剂会减少你的生命值。

你从 $0$ 生命值开始，从第一瓶药剂走到最后一瓶。在每瓶药剂处，你可以选择饮用它或忽略它。你必须确保你的生命值始终为非负数。

你能喝的药剂数量最多是多少？

#### 输入描述：
第一行包含一个整数 $n$ ($1 \leq n \leq 200000$) — 药水的数量。

第二行包含 $n$ 个整数 $a_1, a_2, ..., a_n$ ($-10^9 \leq a_i \leq 10^9$)，表示饮用该药水后的健康变化。

#### 输出描述：
输出一个整数，表示你能够喝下的最大药水数量，而不使你的健康值变为负数。
#### 样例输入输出：
|输入1| 输出1 |
|-- | -- |
|6<br/>4 -4 1 -3 1 -3<br/>|5|
#### 样例解释：
对于这个样例，你可以通过饮用第1、3、4、5和6号药剂来饮用5瓶药剂。但不可能饮用所有6瓶药剂，因为你的健康值会在某个时刻变为负数。